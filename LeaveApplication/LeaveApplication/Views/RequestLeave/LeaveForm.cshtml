@model System.Data.DataSet
<style>
    .LB {
        margin-left: 90px;
    }
</style>
<div class="container mt-lg-5 mt-5">
    <div class="row  justify-content-center  vh-100">

        <div class="col-12 col-sm-12 col-md-6 col-lg-6 ">


            @using (Html.BeginForm("Submit", "RequestLeave", FormMethod.Post, new { id = "form1", onsubmit = "return OnSubmit()" }))
            {

                <div class="card ">
                    <div class="card-header card-header-info">
                        <div class="row">
                            @if (ViewBag.ViewID == 1)
                            {
                                <div class="col">
                                    <div class="custom-control custom-radio">
                                        <input type="radio" id="customRadio1" name="IsHalfDay" class="custom-control-input" value="0">
                                        <label class="custom-control-label text-white" for="customRadio1">Full day</label>
                                    </div>
                                </div>
                                <div class="col">
                                    <div class="custom-control custom-radio">
                                        <input type="radio" id="customRadio2" name="IsHalfDay" class="custom-control-input" value="1" checked>
                                        <label class="custom-control-label text-white" for="customRadio2">Half Day</label>
                                    </div>
                                </div>
                            }
                            else
                            {
                                <div class="col">
                                    <div class="custom-control custom-radio">
                                        <input type="radio" id="customRadio1" name="IsHalfDay" class="custom-control-input" value="0" checked>
                                        <label class="custom-control-label text-white" for="customRadio1">Full day</label>
                                    </div>
                                </div>
                                <div class="col">
                                    <div class="custom-control custom-radio">
                                        <input type="radio" id="customRadio2" name="IsHalfDay" class="custom-control-input" value="1">
                                        <label class="custom-control-label text-white" for="customRadio2">Half Day</label>
                                    </div>
                                </div>
                            }
                        </div>


                    </div>
                    <div class=" card-body ">

                        <label style="font-size:22px" id="date" for="">Date Of Application: @System.DateTime.Now.Date.ToString("dd-MM-yyyy")</label>
                        <br><br>
                        <label class="label-control text-left LB"> Select Leave</label>
                        <div class="form-group d-flex justify-content-center ">

                            <select class="form-control" name="LeaveType" id="LeaveType" required>
                                <option value="" selected disabled> Select Leave Type</option>
                                @{
                                    foreach (System.Data.DataRow x in Model.Tables[0].Rows)
                                    {
                                        <option value="@x[0].ToString()">@x[1].ToString()</option>
                                    }
                                }
                            </select>
                            @Html.ValidationMessage("LeaveType", new { @class = "text-danger" })
                        </div>
                        @{if (ViewBag.ViewID == 0)
                            { <label for="date1" class="text-left LB" id="l2">From</label>
                                <div class="form-group d-flex justify-content-center">


                                    <input class="form-control datetimepicker" type="text" name="FromDate" id="FromDate" required onfocusout="DateSelect(this)">
                                    <span style="margin-left:-20px"><img id="i1" src="~/Images/calendar-clipart-w4.png" width="25" /></span>
                                    @Html.ValidationMessage("FromDate", new { @class = "text-danger" })
                                </div>
                                <label for="date2" id="l3" class="text-left LB">To</label>
                                <div class="form-group d-flex justify-content-center">

                                    <input class="form-control datetimepicker" type="text" name="ToDate" id="ToDate" required onfocusout="DateSelect(this)">
                                    <span style="margin-left:-20px"><img id="i1" src="~/Images/calendar-clipart-w4.png" width="25" /></span>
                                    @Html.ValidationMessage("ToDate", new { @class = "text-danger" })
                                </div>
                                <label for="days" class="text-left LB">Total Days</label>
                                <div class=" form-group d-flex justify-content-center">

                                    <input class="form-control" type="text" name="days" id="days" readonly>

                                </div>

                            }
                            else if (ViewBag.ViewID == 1)
                            {

                                <label class="label-control text-left LB" id="hf1">From date</label>
                                <div class="form-group d-flex justify-content-center">

                                    <input class="form-control datetimepicker" type="text" id="Date" name="Date" required onfocusout="" />
                                    <span style="margin-left:-20px"><img id="i1" src="~/Images/calendar-clipart-w4.png" width="25" /></span>
                                    @Html.ValidationMessage("Date", new { @class = "text-danger" })
                                </div>
                                <label class="label-control text-left LB" id="hf1">From time</label>
                                <div class="form-group d-flex justify-content-center">

                                    <input type="text" class="form-control datetimepicker2" id="halfday_from" name="halfday_from" required />
                                    <span style="margin-left:-20px"><img id="i1" src="~/Images/calendar-clipart-w4.png" width="25" /></span>
                                    @Html.ValidationMessage("halfday_from", new { @class = "text-danger" })
                                </div>
                                <label class="label-control text-left LB" id="hf2">To time</label>
                                <div class="form-group d-flex justify-content-center">

                                    <input type="text" class="form-control datetimepicker2" id="halfday_to" name="halfday_to" required />
                                    <span style="margin-left:-20px"><img id="i1" src="~/Images/calendar-clipart-w4.png" width="25" /></span>
                                    @Html.ValidationMessage("halfday_to", new { @class = "text-danger" })
                                </div>
                                <label for="days" class="text-left LB">Total Days</label>
                                <div class=" form-group d-flex justify-content-center">

                                    <input class="form-control" type="text" name="days" id="days" value="0.5" readonly>

                                </div>
                                if (ViewBag.HrsError == true)
                                {
                                    <div id="alert" class=" alert alert-danger  fade-in">

                                        <strong>Error!</strong> Exceeds hours Limitation
                                    </div>
                                }


                            }
                            if (ViewBag.HrsError == true)
                            {
                                <div id="alert" class=" alert alert-danger  fade-in">

                                    <strong>Error!</strong> Exceeds hours Limitation
                                </div>
                            }
                        }



                        <label class="label-control text-left LB"> Select Reason</label>
                        <div class="form-group d-flex justify-content-center">
                            <select class="form-control" name="LeaveReason" id="LeaveReason" required>
                                <option value="" selected disabled>Reason For Leave</option>
                                @{ System.Data.DataSet i = ViewBag.Reasons;
                                    foreach (System.Data.DataRow x in i.Tables[0].Rows)
                                    {
                                        <option value="@x[0].ToString()">@x[1].ToString()</option>
                                    }
                                }
                            </select>
                            @Html.ValidationMessage("LeaveReason", new { @class = "text-danger" })
                        </div>
                        <div class="d-flex justify-content-center">
                            <div class="form-group col-8">
                                <label class="label-control" for="LeaveRemarks"> Enter Description</label><br />
                                <div class="p-1" style="border:solid 1px #A9A9A9">
                                    <textarea class="form-control " style="resize:none" name="LeaveRemarks" id="LeaveRemarks" cols="30" rows="5" placeholder="Enter Description if any."></textarea>

                                </div>
                            </div>
                        </div>


                    </div>
                    <div class="d-flex justify-content-center card-footer">

                        <input id="Submit1" class="btn btn-round btn-info-grd col-lg-10" type="submit" value="submit" />



                    </div>

                </div>

            }





        </div>

    </div>

</div>



<script>

    $(document).ready(function () {

        if (document.getElementById("alert")) {
            setTimeout(Hide, 3000)
        }
        function Hide() {
            $('#alert').hide('fade');
        }
        $('#customRadio1').click(function () {

            GetView(0);
        });
        $('#customRadio2').click(function () {


            GetView(1);
        });

        $('.datetimepicker').datetimepicker({
            format: 'DD/MM/YYYY',

            icons: {
                time: "fa fa-clock-o",
                date: "fa fa-calendar",
                up: "fa fa-chevron-up",
                down: "fa fa-chevron-down",
                previous: 'fa fa-chevron-left',
                next: 'fa fa-chevron-right',
                today: 'fa fa-screenshot',
                clear: 'fa fa-trash',
                close: 'fa fa-remove',

            }

        });
        $('.datetimepicker1').datetimepicker({
            format: 'DD/MM/YYYY LT',

            icons: {
                time: "fa fa-clock-o",
                date: "fa fa-calendar",
                up: "fa fa-chevron-up",
                down: "fa fa-chevron-down",
                previous: 'fa fa-chevron-left',
                next: 'fa fa-chevron-right',
                today: 'fa fa-screenshot',
                clear: 'fa fa-trash',
                close: 'fa fa-remove',

            }

        });
        $('.datetimepicker2').datetimepicker({
            format: 'LT',
            icons: {
                time: "fa fa-clock-o",
                date: "fa fa-calendar",
                up: "fa fa-chevron-up",
                down: "fa fa-chevron-down",
                previous: 'fa fa-chevron-left',
                next: 'fa fa-chevron-right',
                today: 'fa fa-screenshot',
                clear: 'fa fa-trash',
                close: 'fa fa-remove',

            }

        });
        function OnSubmit() {
            if ($('#LeaveType').val() == null || $('#halfday').val() == null || $('#FromDate').val() == null || $('#ToDate').val() == null || $('#LeaveReason').val() == null) {
                alert("Kindly Fill all the fields");
                return false;
            }
        }
        function GetView(ViewId) {
            $('#empdiv').html('');
            $.ajax({
                type: "post",
                url: "/RequestLeave/GetView?ViewId=" + ViewId,

                success: function (html) {

                    $('#empdiv').html(html);

                }


            })
        }
    });
    var Date1 = null;
    var Date2 = null;
    function DateSelect(date) {

        var LeaveDetails = { FromDate: "", ToDate: "" };

        if (date.name == "FromDate") {
            Date1 = date.value;
            LeaveDetails.FromDate = Date1;
            LeaveDetails.ToDate = Date2;

        }
        else {
            Date2 = date.value;
            LeaveDetails.FromDate = Date1;
            LeaveDetails.ToDate = Date2;
        }


        if ((Date1 != null && Date1 != "") && (Date2 != null && Date2 != "")) {

            var xmlhttp = new XMLHttpRequest();
            xmlhttp.onreadystatechange = fun;
            function fun() {
                if (this.readyState == 4 && this.status == 200) {

                    var x = JSON.parse(this.responseText);

                    document.getElementById("days").value = x;

                }
            };
            xmlhttp.open("POST", "/ApplyForLeave/Calculateadays", true);
            xmlhttp.setRequestHeader("Content-Type", "application/json");
            xmlhttp.send(JSON.stringify(LeaveDetails));
        }


    }

</script>

